<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex, nofollow">
    <title>Password Protected Page</title>
    <style>
        html, body {
            margin: 0;
            width: 100%;
            height: 100%;
            font-family: Arial, Helvetica, sans-serif;
        }
        #dialogText {
            color: white;
            background-color: #333333;
        }
        
        #dialogWrap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: table;
            background-color: #EEEEEE;
        }
        
        #dialogWrapCell {
            display: table-cell;
            text-align: center;
            vertical-align: middle;
        }
        
        #mainDialog {
            max-width: 400px;
            margin: 5px;
            border: solid #AAAAAA 1px;
            border-radius: 10px;
            box-shadow: 3px 3px 5px 3px #AAAAAA;
            margin-left: auto;
            margin-right: auto;
            background-color: #FFFFFF;
            overflow: hidden;
            text-align: left;
        }
        #mainDialog > * {
            padding: 10px 30px;
        }
        #passArea {
            padding: 20px 30px;
            background-color: white;
        }
        #passArea > * {
            margin: 5px auto;
        }
        #pass {
            width: 100%;
            height: 40px;
            font-size: 30px;
        }
        
        #messageWrapper {
            float: left;
            vertical-align: middle;
            line-height: 30px;
        }
        
        .notifyText {
            display: none;
        }
        
        #invalidPass {
            color: red;
        }
        
        #success {
            color: green;
        }
        
        #submitPass {
            font-size: 20px;
            border-radius: 5px;
            background-color: #E7E7E7;
            border: solid gray 1px;
            float: right;
            cursor: pointer;
        }
        #contentFrame {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        #attribution {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            text-align: center;
            padding: 10px;
            font-weight: bold;
            font-size: 0.8em;
        }
        #attribution, #attribution a {
            color: #999;
        }
        .error {
            display: none;
            color: red;
        }
    </style>
  </head>
  <body>
    <iframe id="contentFrame" frameBorder="0" allowfullscreen></iframe>
    <div id="dialogWrap">
        <div id="dialogWrapCell">
            <div id="mainDialog">
                <div id="dialogText">This page is password protected.</div>
                <div id="passArea">
                    <p id="passwordPrompt">Password</p>
                    <input id="pass" type="password" name="pass" autofocus>
                    <div>
                        <span id="messageWrapper">
                            <span id="invalidPass" class="error">Sorry, please try again.</span>
                            <span id="trycatcherror" class="error">Sorry, something went wrong.</span>
                            <span id="success" class="notifyText">Success!</span>
                            &nbsp;
                        </span>
                        <button id="submitPass" type="button">Submit</button>
                        <div style="clear: both;"></div>
                    </div>
                </div>
                <div id="securecontext" class="error">
                    <p>
                        Sorry, but password protection only works over a secure connection. Please load this page via HTTPS.
                    </p>
                </div>
                <div id="nocrypto" class="error">
                    <p>
                        Your web browser appears to be outdated. Please visit this page using a modern browser.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <div id="attribution">
        Protected by <a href="https://www.maxlaumeister.com/pagecrypt/">PageCrypt</a>
    </div>
    <script>
    (function() {

        var pl = "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";
        
        var submitPass = document.getElementById('submitPass');
        var passEl = document.getElementById('pass');
        var invalidPassEl = document.getElementById('invalidPass');
        var trycatcherror = document.getElementById('trycatcherror');
        var successEl = document.getElementById('success');
        var contentFrame = document.getElementById('contentFrame');
        
        // Sanity checks

        if (pl === "") {
            submitPass.disabled = true;
            passEl.disabled = true;
            alert("This page is meant to be used with the encryption tool. It doesn't work standalone.");
            return;
        }

        if (!isSecureContext) {
            document.querySelector("#passArea").style.display = "none";
            document.querySelector("#securecontext").style.display = "block";
            return;
        }

        if (!crypto.subtle) {
            document.querySelector("#passArea").style.display = "none";
            document.querySelector("#nocrypto").style.display = "block";
            return;
        }
        
        function str2ab(str) {
            var ustr = atob(str);
            var buf = new ArrayBuffer(ustr.length);
            var bufView = new Uint8Array(buf);
            for (var i=0, strLen=ustr.length; i < strLen; i++) {
                bufView[i] = ustr.charCodeAt(i);
            }
            return bufView;
        }

        async function deriveKey(salt, password) {
            const encoder = new TextEncoder()
            const baseKey = await crypto.subtle.importKey(
                'raw',
                encoder.encode(password),
                'PBKDF2',
                false,
                ['deriveKey'],
            )
            return await crypto.subtle.deriveKey(
                { name: 'PBKDF2', salt, iterations: 100000, hash: 'SHA-256' },
                baseKey,
                { name: 'AES-GCM', length: 256 },
                true,
                ['decrypt'],
            )
        }
        
        async function doSubmit(evt) {
            submitPass.disabled = true;
            passEl.disabled = true;

            let iv, ciphertext, key;
            
            try {
                var unencodedPl = str2ab(pl);

                const salt = unencodedPl.slice(0, 32)
                iv = unencodedPl.slice(32, 32 + 16)
                ciphertext = unencodedPl.slice(32 + 16)

                key = await deriveKey(salt, passEl.value);
            } catch (e) {
                trycatcherror.style.display = "inline";
                console.error(e);
                return;
            }

            try {
                const decryptedArray = new Uint8Array(
                    await crypto.subtle.decrypt({ name: 'AES-GCM', iv }, key, ciphertext)
                );

                let decrypted = new TextDecoder().decode(decryptedArray);

                if (decrypted === "") throw "No data returned";

                const basestr = '<base href="." target="_top">';
                const anchorfixstr = `
                    <script>
                        Array.from(document.links).forEach((anchor) => {
                            const href = anchor.getAttribute("href");
                            if (href.startsWith("#")) {
                                anchor.addEventListener("click", function(e) {
                                    e.preventDefault();
                                    const targetId = this.getAttribute("href").substring(1);
                                    const targetEl = document.getElementById(targetId);
                                    targetEl.scrollIntoView();
                                });
                            }
                        });
                    <\/script>
                `;
                
                // Set default iframe link targets to _top so all links break out of the iframe
                if (decrypted.includes("<head>")) decrypted = decrypted.replace("<head>", "<head>" + basestr);
                else if (decrypted.includes("<!DOCTYPE html>")) decrypted = decrypted.replace("<!DOCTYPE html>", "<!DOCTYPE html>" + basestr);
                else decrypted = basestr + decrypted;

                // Fix fragment links
                if (decrypted.includes("</body>")) decrypted = decrypted.replace("</body>", anchorfixstr + '</body>');
                else if (decrypted.includes("</html>")) decrypted = decrypted.replace("</html>", anchorfixstr + '</html>');
                else decrypted = decrypted + anchorfixstr;
                
                contentFrame.srcdoc = decrypted;
                
                successEl.style.display = "inline";
                setTimeout(function() {
                    dialogWrap.style.display = "none";
                }, 1000);
            } catch (e) {
                invalidPassEl.style.display = "inline";
                passEl.value = "";
                submitPass.disabled = false;
                passEl.disabled = false;
                console.error(e);
                return;
            }
        }
        
        submitPass.onclick = doSubmit;
        passEl.onkeypress = function(e){
            if (!e) e = window.event;
            var keyCode = e.keyCode || e.which;
            invalidPassEl.style.display = "none";
            if (keyCode == '13'){
              // Enter pressed
              doSubmit();
              return false;
            }
        }
    })();
    </script>
  </body>
</html>
